# ユースケース

## アクター

- **ユーザー:** コントローラーを操作する人。
- **システム:** 列車本体のソフトウェア。

---

### UC-01: システムの初期化

- **ユースケース名:** システムの初期化
- **アクター:** システム
- **概要:** 列車の電源が投入され、コントローラーと通信するための準備を行います。
- **フロー:**
    1. システムの電源がONになる。
    2. Wi-Fiをステーションモードで起動する。
    3. ESP-NOW通信を初期化する。
    4. 事前に設定されたMACアドレスを持つコントローラーとのペアリングを試みる。
    5. ペアリングが成功すると、操作待機状態に移行する。

---

### UC-02: 列車の運転操作

- **ユースケース名:** 列車の運転操作
- **アクター:** ユーザー
- **概要:** ユーザーはコントローラーを操作して、列車を前進、後進、停止させます。速度も調整可能です。
- **フロー:**
    1. ユーザーがコントローラーのスライダーを操作して、速度と方向を指示する。
    2. コントローラーが操作内容をコマンドとしてシステム（列車）に送信する。
    3. システムは受信したコマンドを解析し、モーターを制御して指示通りに動作する。
        - **前進:** 指定された速度で前進する。
        - **後進:** 指定された速度で後進する。
        - **停止:** モーターを停止する。

---

### UC-03: ライトの操作

- **ユースケース名:** ライトの操作
- **アクター:** ユーザー
- **概要:** ユーザーはコントローラーのスイッチを操作して、列車のライトを点灯または消灯します。
- **フロー:**
    1. ユーザーがコントローラーのライト用スイッチを操作する。
    2. コントローラーが操作内容をコマンドとしてシステム（列車）に送信する。
    3. システムは受信したコマンドに応じてライトを点灯または消灯する。

---

### UC-04: ブザーの操作

- **ユースケース名:** ブザーの操作
- **アクター:** ユーザー
- **概要:** ユーザーはコントローラーのスイッチを操作して、列車のブザーを鳴らしたり止めたりします。
- **フロー:**
    1. ユーザーがコントローラーのブザー用スイッチを操作する。
    2. コントローラーが操作内容をコマンドとしてシステム（列車）に送信する。
    3. システムは受信したコマンドに応じてブザーを鳴らす、または止める。

---

### UC-05: バッテリー電圧の監視

- **ユースケース名:** バッテリー電圧の監視
- **アクター:** システム
- **概要:** システムは自身のバッテリー電圧を定期的に測定し、コントローラーに送信します。
- **フロー:**
    1. システムが定期的にバッテリー電圧を測定する。
    2. 測定した電圧データをテレメトリとしてコントローラーに送信する。
    3. (コントローラー側) 受信した電圧データを表示する。

---

### UC-06: 通信切断時の対応

- **ユースケース名:** 通信切断時の対応
- **アクター:** システム
- **概要:** コントローラーとの通信が途絶えた場合、安全のために列車を自動的に停止させます。
- **フロー:**
    1. システムがコントローラーからのデータ受信が一定時間途絶えたことを検知する。
    2. システムは危険を回避するため、モーター、ライト、ブザーを全て停止・OFFにする。
    3. 通信が復帰するまで待機する。
